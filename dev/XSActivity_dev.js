var XiaoSuActivity=function(exports){"use strict";const XSActivity_VERSION="v0.1.4",DEBUG=!0;function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var bcmodsdk={};!function(exports){!function(){const e="1.1.0";function o(e){alert("Mod ERROR:\n"+e);const o=new Error(e);throw console.error(o),o}const t=new TextEncoder;function n(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function r(e){const o=new Set;return e.filter((e=>!o.has(e)&&o.add(e)))}const i=new Map,a=new Set;function d(e){a.has(e)||(a.add(e),console.warn(e))}function s(e){const o=[],t=new Map,n=new Set;for(const r of p.values()){const i=r.patching.get(e.name);if(i){o.push(...i.hooks);for(const[o,a]of i.patches.entries())t.has(o)&&t.get(o)!==a&&d(`ModSDK: Mod '${r.name}' is patching function ${e.name} with same pattern that is already applied by different mod, but with different pattern:\nPattern:\n${o}\nPatch1:\n${t.get(o)||""}\nPatch2:\n${a}`),t.set(o,a),n.add(r.name)}}o.sort(((e,o)=>o.priority-e.priority));const r=function(e,o){if(0===o.size)return e;let t=e.toString().replaceAll("\r\n","\n");for(const[n,r]of o.entries())t.includes(n)||d(`ModSDK: Patching ${e.name}: Patch ${n} not applied`),t=t.replaceAll(n,r);return(0,eval)(`(${t})`)}(e.original,t);let i=function(o){var t,i;const a=null===(i=(t=m.errorReporterHooks).hookChainExit)||void 0===i?void 0:i.call(t,e.name,n),d=r.apply(this,o);return null==a||a(),d};for(let t=o.length-1;t>=0;t--){const n=o[t],r=i;i=function(o){var t,i;const a=null===(i=(t=m.errorReporterHooks).hookEnter)||void 0===i?void 0:i.call(t,e.name,n.mod),d=n.hook.apply(this,[o,e=>{if(1!==arguments.length||!Array.isArray(o))throw new Error(`Mod ${n.mod} failed to call next hook: Expected args to be array, got ${typeof e}`);return r.call(this,e)}]);return null==a||a(),d}}return{hooks:o,patches:t,patchesSources:n,enter:i,final:r}}function c(e,o=!1){let r=i.get(e);if(r)o&&(r.precomputed=s(r));else{let o=window;const a=e.split(".");for(let t=0;t<a.length-1;t++)if(o=o[a[t]],!n(o))throw new Error(`ModSDK: Function ${e} to be patched not found; ${a.slice(0,t+1).join(".")} is not object`);const d=o[a[a.length-1]];if("function"!=typeof d)throw new Error(`ModSDK: Function ${e} to be patched not found`);const c=function(e){let o=-1;for(const n of t.encode(e)){let e=255&(o^n);for(let o=0;o<8;o++)e=1&e?-306674912^e>>>1:e>>>1;o=o>>>8^e}return((-1^o)>>>0).toString(16).padStart(8,"0").toUpperCase()}(d.toString().replaceAll("\r\n","\n")),l={name:e,original:d,originalHash:c};r=Object.assign(Object.assign({},l),{precomputed:s(l),router:()=>{},context:o,contextProperty:a[a.length-1]}),r.router=function(e){return function(...o){return e.precomputed.enter.apply(this,[o])}}(r),i.set(e,r),o[r.contextProperty]=r.router}return r}function l(){const e=new Set;for(const o of p.values())for(const t of o.patching.keys())e.add(t);for(const o of i.keys())e.add(o);for(const o of e)c(o,!0)}function f(){const e=new Map;for(const[o,t]of i)e.set(o,{name:o,original:t.original,originalHash:t.originalHash,sdkEntrypoint:t.router,currentEntrypoint:t.context[t.contextProperty],hookedByMods:r(t.precomputed.hooks.map((e=>e.mod))),patchedByMods:Array.from(t.precomputed.patchesSources)});return e}const p=new Map;function u(e){p.get(e.name)!==e&&o(`Failed to unload mod '${e.name}': Not registered`),p.delete(e.name),e.loaded=!1,l()}function g(e,t,r){"string"==typeof e&&"string"==typeof t&&(alert(`Mod SDK warning: Mod '${e}' is registering in a deprecated way.\nIt will work for now, but please inform author to update.`),e={name:e,fullName:e,version:t},t={allowReplace:!0===r}),e&&"object"==typeof e||o("Failed to register mod: Expected info object, got "+typeof e),"string"==typeof e.name&&e.name||o("Failed to register mod: Expected name to be non-empty string, got "+typeof e.name);let i=`'${e.name}'`;"string"==typeof e.fullName&&e.fullName||o(`Failed to register mod ${i}: Expected fullName to be non-empty string, got ${typeof e.fullName}`),i=`'${e.fullName} (${e.name})'`,"string"!=typeof e.version&&o(`Failed to register mod ${i}: Expected version to be string, got ${typeof e.version}`),e.repository||(e.repository=void 0),void 0!==e.repository&&"string"!=typeof e.repository&&o(`Failed to register mod ${i}: Expected repository to be undefined or string, got ${typeof e.version}`),null==t&&(t={}),t&&"object"==typeof t||o(`Failed to register mod ${i}: Expected options to be undefined or object, got ${typeof t}`);const a=!0===t.allowReplace,d=p.get(e.name);d&&(d.allowReplace&&a||o(`Refusing to load mod ${i}: it is already loaded and doesn't allow being replaced.\nWas the mod loaded multiple times?`),u(d));const s=e=>{"string"==typeof e&&e||o(`Mod ${i} failed to patch a function: Expected function name string, got ${typeof e}`);let t=g.patching.get(e);return t||(t={hooks:[],patches:new Map},g.patching.set(e,t)),t},f={unload:()=>u(g),hookFunction:(e,t,n)=>{g.loaded||o(`Mod ${i} attempted to call SDK function after being unloaded`);const r=s(e);"number"!=typeof t&&o(`Mod ${i} failed to hook function '${e}': Expected priority number, got ${typeof t}`),"function"!=typeof n&&o(`Mod ${i} failed to hook function '${e}': Expected hook function, got ${typeof n}`);const a={mod:g.name,priority:t,hook:n};return r.hooks.push(a),l(),()=>{const e=r.hooks.indexOf(a);e>=0&&(r.hooks.splice(e,1),l())}},patchFunction:(e,t)=>{g.loaded||o(`Mod ${i} attempted to call SDK function after being unloaded`);const r=s(e);n(t)||o(`Mod ${i} failed to patch function '${e}': Expected patches object, got ${typeof t}`);for(const[n,a]of Object.entries(t))"string"==typeof a?r.patches.set(n,a):null===a?r.patches.delete(n):o(`Mod ${i} failed to patch function '${e}': Invalid format of patch '${n}'`);l()},removePatches:e=>{g.loaded||o(`Mod ${i} attempted to call SDK function after being unloaded`),s(e).patches.clear(),l()},callOriginal:(e,t,n)=>(g.loaded||o(`Mod ${i} attempted to call SDK function after being unloaded`),"string"==typeof e&&e||o(`Mod ${i} failed to call a function: Expected function name string, got ${typeof e}`),Array.isArray(t)||o(`Mod ${i} failed to call a function: Expected args array, got ${typeof t}`),function(e,o,t=window){return c(e).original.apply(t,o)}(e,t,n)),getOriginalHash:e=>("string"==typeof e&&e||o(`Mod ${i} failed to get hash: Expected function name string, got ${typeof e}`),c(e).originalHash)},g={name:e.name,fullName:e.fullName,version:e.version,repository:e.repository,allowReplace:a,api:f,loaded:!0,patching:new Map};return p.set(e.name,g),Object.freeze(f)}function h(){const e=[];for(const o of p.values())e.push({name:o.name,fullName:o.fullName,version:o.version,repository:o.repository});return e}let m;const y=function(){if(void 0===window.bcModSdk)return window.bcModSdk=function(){const o={version:e,apiVersion:1,registerMod:g,getModsInfo:h,getPatchingInfo:f,errorReporterHooks:Object.seal({hookEnter:null,hookChainExit:null})};return m=o,Object.freeze(o)}();if(n(window.bcModSdk)||o("Failed to init Mod SDK: Name already in use"),1!==window.bcModSdk.apiVersion&&o(`Failed to init Mod SDK: Different version already loaded ('1.1.0' vs '${window.bcModSdk.version}')`),window.bcModSdk.version!==e&&(alert(`Mod SDK warning: Loading different but compatible versions ('1.1.0' vs '${window.bcModSdk.version}')\nOne of mods you are using is using an old version of SDK. It will work for now but please inform author to update`),window.bcModSdk.version.startsWith("1.0.")&&void 0===window.bcModSdk._shim10register)){const e=window.bcModSdk,o=Object.freeze(Object.assign(Object.assign({},e),{registerMod:(o,t,n)=>o&&"object"==typeof o&&"string"==typeof o.name&&"string"==typeof o.version?e.registerMod(o.name,o.version,"object"==typeof t&&!!t&&!0===t.allowReplace):e.registerMod(o,t,n),_shim10register:!0}));window.bcModSdk=o}return window.bcModSdk}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=y}()}(bcmodsdk);var bcModSDKRef=getDefaultExportFromCjs(bcmodsdk);const modules={};var ChangeType;!function(ChangeType){ChangeType[ChangeType.main=0]="main",ChangeType[ChangeType.dev=1]="dev"}(ChangeType||(ChangeType={}));let CHANGELOG=[{version:"0.0.1",description:"Initial release",type:ChangeType.dev,changes:["å®ŒæˆåŸºæœ¬æ¡†æ¶æµ‹è¯•ä¸­..."]},{version:"0.0.2",description:"ä¿®å¤",type:ChangeType.dev,changes:["ä¿®å¤è‹¥å¹²bug","æ·»åŠ éƒ¨åˆ†åŠ¨ä½œ"]},{version:"0.0.3",description:"ä¿®å¤",type:ChangeType.dev,changes:["ä¿®å¤è‹¥å¹²bug","å®Œå–„æ¡†æ¶"]},{version:"0.0.4",description:"ç»ˆäºä¿®å¤äº†é‡å¤åŠ è½½çš„Bug",type:ChangeType.dev,changes:["ä¿®å¤é‡å¤åŠ è½½çš„BUG!!!!!! O.o","ä¿®å¤è‹¥å¹²å…¶ä»–bug","å®Œå–„æ¡†æ¶"]},{version:"0.0.5",description:"ä¼˜åŒ–",type:ChangeType.dev,changes:["ä¼˜åŒ–ç‰ˆæœ¬ä¿¡æ¯æ˜¾ç¤ºæ•ˆæœ"]},{version:"0.1.0",description:"æ­£å¼å‘å¸ƒ!å½“å‰åŠŸèƒ½å¦‚ä¸‹: ",type:ChangeType.main,changes:["ä½¿ç”¨å‘½ä»¤å¯¼å‡ºå½“å‰èŠå¤©å®¤èŠå¤©è®°å½• æ”¯æŒæŒ‰æ—¶é—´èŒƒå›´å¯¼å‡º è¯¦ç»†è¯·æŸ¥çœ‹ /xsa ","æ·»åŠ 9ä¸ªé¢å¤–åŠ¨ä½œ."]},{version:"0.1.1",description:"æ·»åŠ äº†æ–°çš„åŠ¨ä½œ.",type:ChangeType.main,changes:["æ·»åŠ äº†é¢å¤–çš„17ä¸ªåŠ¨ä½œ","æ·»åŠ  /xsa act å‘½ä»¤ æ˜¾ç¤ºæ·»åŠ çš„å…¨éƒ¨åŠ¨ä½œ","å®ŒæˆåŠŸèƒ½è‡ªåŠ¨å£åƒå¤„ç†å‘½ä»¤:(` + message) --è¯·è¾“å…¥ /xsa jieba æŸ¥çœ‹å¸®åŠ©"]},{version:"0.1.2",description:"æ·»åŠ ä¿®æ”¹è¾¹ç¼˜é€»è¾‘.",type:ChangeType.main,changes:["ä¿®å¤ä¸€äº›bug","ä¿®å¤äº†è‹¥å¹²é”™åˆ«å­—","ä¿®æ”¹è¾¹ç¼˜å½±å“ï¼Œç°åœ¨æ¯45ç§’é’Ÿ è¾¹ç¼˜ ,å°†æé«˜ä¸€å±‚é«˜æ½®æŠµæŠ—éš¾åº¦ï¼Œå¹¶ä¸”å¢åŠ 0.3~1.3ç§’çš„å³å°†åˆ°æ¥çš„é«˜æ½®çš„æŒç»­æ—¶é—´-æœ€å¤š27ç§’æŒç»­æ—¶é—´ï¼Œå¦‚æœå¤±å»è¾¹ç¼˜çŠ¶æ€ï¼Œåˆ™åŒæ ·çš„æ—¶é—´åå¤±å»ä¸€å±‚æŠµæŠ—éš¾åº¦ï¼Œå¹¶ä¸”å‡å°‘0.3~1.3ç§’é«˜æ½®æŒç»­æ—¶é—´."]},{version:"0.1.3",description:"æ·»åŠ ä¿®æ”¹è¾¹ç¼˜é€»è¾‘ä»¥åŠé«˜æ½®æ•ˆæœ.æ·»åŠ æ‰“æ–­æŠµæŠ—é«˜æ½®çš„ç˜™ç—’åŠ¨ä½œ.",type:ChangeType.main,changes:["å½“è§’è‰²æŠµæŠ—é«˜æ½®æ—¶è¢«æŒ ç—’ï¼Œåˆ™é‡æ–°å¼€å§‹æŠµæŠ—å¹¶ä¸”å¢åŠ ä¸€å±‚éš¾åº¦","å½“é«˜æ½®æˆ–æŠµæŠ—é«˜æ½®æ—¶ç¦ç”¨è¾“å…¥æ¡†."," ` å‘½ä»¤ä¿®æ”¹ï¼Œç°åœ¨å¯ä»¥åœ¨ ` åæˆ–è€… æ•°å­—åè·Ÿä¸€ä¸ªå­—æ¯ m ï¼Œè¿™å°†åœ¨ç»“å·´ä½ç½®æ·»åŠ å‘»åŸæ•ˆæœ."]},{version:"0.1.4",description:"æ·»åŠ é¢œæ–‡å­—å¿«é€Ÿå‘é€åŠŸèƒ½!",type:ChangeType.dev,changes:["æ·»åŠ å¿«é€Ÿå‘é€é¢œæ–‡å­—çš„åŠŸèƒ½ï¼Œä»¥ä¸‹ä¸ºç®€å•ä»‹ç»ï¼Œè¯¦ç»†ä»‹ç»è¯·è¾“å…¥:/xsa kaomoji æŸ¥çœ‹ã€‚\nä½¿ç”¨=> |+[å‚æ•°]  æ‰“å¼€é¢œæ–‡å­—é€‰æ‹©é¢æ¿ï¼Œ| ä¸ºå›è½¦ä¸Šé¢çš„æŒ‰é”®ï¼Œéœ€è¦ç”¨ Shift+\\ é”®æ‰“å‡º è¯·è¾“å…¥ |help æŸ¥çœ‹å…¨éƒ¨å‚æ•°","è°ƒæ•´å¿è€é«˜æ½®æ—¶æ¯1.5ç§’æœ‰30%æ¦‚ç‡å‘é€å¿è€ååº”","é«˜æ½®åçš„é«˜æ½®æŠµæŠ—éš¾åº¦åªé™ä½ä¸€åŠè€ŒéåŸæ¥çš„é™ä½ä¸º0."]}];const bcModSDK=bcModSDKRef.registerMod({name:"XiaoSuActivity",fullName:"XiaoSu's Activity Expand",version:XSActivity_VERSION.startsWith("v")?XSActivity_VERSION.slice(1):XSActivity_VERSION,repository:"https://github.com/iceriny/XiaoSuActivity"});var ModuleCategory,MSGType;function hookFunction(target,priority,hook){return bcModSDK.hookFunction(target,priority,hook)}function SendActivity(msg,sourceCharacter,targetCharacter){const sourceCharacterObj=ChatRoomCharacter.find((c=>c.MemberNumber==sourceCharacter)),targetCharacterObj=targetCharacter?ChatRoomCharacter.find((c=>c.MemberNumber==targetCharacter)):void 0;if(void 0===sourceCharacterObj&&void 0===targetCharacterObj)return;const sourceCharacterNickname=sourceCharacterObj?CharacterNickname(sourceCharacterObj):"",targetCharacterNickname=targetCharacterObj?CharacterNickname(targetCharacterObj):"",resultDict=[{Tag:"MISSING ACTIVITY DESCRIPTION FOR KEYWORD XSA_ActMessage",Text:msg.replaceAll("{source}",sourceCharacterNickname).replaceAll("{target}",targetCharacterNickname)}];resultDict.push({SourceCharacter:sourceCharacter}),void 0!==targetCharacter&&resultDict.push({TargetCharacter:targetCharacter}),conDebug({type:MSGType.Workflow_Log,name:"SendActivity()",content:{Type:"Activity",Content:"XSA_ActMessage",Dictionary:resultDict,Sender:sourceCharacter}}),ServerSend("ChatRoomChat",{Type:"Activity",Content:"XSA_ActMessage",Dictionary:resultDict,Sender:sourceCharacter})}function conDebug(msg){if(!1===DEBUG)return;let result="string"==typeof msg?{name:"XiaoSuActivity_Debug",type:MSGType.DebugLog,content:msg,time:(new Date).toLocaleString(),ModVersion:XSActivity_VERSION}:{name:msg.name,type:msg.type,content:msg.content,time:(new Date).toLocaleString(),ModVersion:XSActivity_VERSION};console.debug(result)}function GetModule(moduleName){return modules[moduleName]}function copyAndDownloadHtmlElement(element,fileName,time_limit=null){const newDoc=document.implementation.createHTMLDocument();if(null===element)return void conDebug("element is null");const copiedElement=element.cloneNode(!0);null!==time_limit&&function(element,time_limit){element.querySelectorAll("[data-time]").forEach((element=>{const dataTimeValue=element.getAttribute("data-time");if(dataTimeValue){const currentTime=new Date(`2000-01-01 ${dataTimeValue}`),minTimeDate=new Date(`2000-01-01 ${time_limit.minTime}`),maxTimeDate=new Date(`2000-01-01 ${time_limit.maxTime}`);maxTimeDate<minTimeDate&&maxTimeDate.setDate(maxTimeDate.getDate()+1),(currentTime<minTimeDate||currentTime>maxTimeDate)&&element.remove()}}))}(copiedElement,time_limit),function(element){const style=element.style;for(;style.length>0;)style.removeProperty(style[0])}(copiedElement),copiedElement.style.fontSize="14.784px",copiedElement.style.fontFamily="Arial, sans-serif",copiedElement.style.display="flex",copiedElement.style.flexDirection="column",copiedElement.style.width="70vw",newDoc.body.style.display="flex",newDoc.body.style.alignItems="center",newDoc.body.style.justifyContent="center",newDoc.body.style.backgroundColor="#f2f2f2",newDoc.body.appendChild(copiedElement);const htmlString=newDoc.documentElement.outerHTML,blob=new Blob([htmlString],{type:"text/html"}),link=document.createElement("a");link.href=URL.createObjectURL(blob),link.download=fileName,link.click()}!function(ModuleCategory){ModuleCategory[ModuleCategory.Core=-1]="Core",ModuleCategory[ModuleCategory.Global=0]="Global",ModuleCategory[ModuleCategory.Test=1]="Test"}(ModuleCategory||(ModuleCategory={})),function(MSGType){MSGType[MSGType.DebugLog=0]="DebugLog",MSGType[MSGType.Workflow_Log=1]="Workflow_Log"}(MSGType||(MSGType={}));class BaseModule{constructor(){this.moduleName="Base",this.priority=0,this.Loaded=!1}}const selfPlaceholder="SourceCharacter";class ActivityModule extends BaseModule{constructor(){super(...arguments),this.activityToAddDict={"XSAct_çœ¯çœ¼":{act:{Name:"XSAct_çœ¯çœ¼",Target:[""],TargetSelf:["ItemHead"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:[]},desc:null,descString:["",`${selfPlaceholder}çœ¯äº†çœ¯çœ¼.`],img:"RestHead"},"XSAct_çœ¼ç¥é£˜å¿½":{act:{Name:"XSAct_çœ¼ç¥é£˜å¿½",Target:[""],TargetSelf:["ItemHead"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:[]},desc:null,descString:["",`${selfPlaceholder}çœ¼ç¥é£˜å¿½çš„å·¦çœ‹å³çœ‹.`],img:"RestHead"},"XSAct_ç”©å¤´å‘":{act:{Name:"XSAct_ç”©å¤´å‘",Target:[""],TargetSelf:["ItemHood"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["ItemHoodCovered"]},desc:null,descString:["",`${selfPlaceholder}ç”©åŠ¨ç€å¤´å‘.`],img:"RestHead"},"XSAct_å¤§åŠ›ç”©å¤´å‘":{act:{Name:"XSAct_å¤§åŠ›ç”©å¤´å‘",Target:[""],TargetSelf:["ItemHood"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["ItemHoodCovered"]},desc:null,descString:["",`${selfPlaceholder}è¿è¿æ‘‡å¤´ï¼Œæ…Œä¹±çš„ç”©åŠ¨ç€å¤´å‘.`],img:"RestHead"},"XSAct_è½»æŠšå‘æ¢¢":{act:{Name:"XSAct_è½»æŠšå‘æ¢¢",Target:["ItemHood"],TargetSelf:["ItemHood"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["ItemHoodCovered","TargetItemHoodCovered","CantUseArms"]},desc:null,descString:[`${selfPlaceholder}è½»æŸ”æŠšåŠ¨ç€TargetCharacterçš„å¤´å‘.`,`${selfPlaceholder}è½»æŸ”æŠšåŠ¨ç€è‡ªå·±çš„å¤´å‘.`],img:"RestHead"},"XSAct_å¼èµ·å¤´å‘":{act:{Name:"XSAct_å¼èµ·å¤´å‘",Target:["ItemHood"],TargetSelf:["ItemHood"],MaxProgress:50,MaxProgressSelf:20,Prerequisite:["UseMouth","ItemHoodCovered","TargetItemHoodCovered"],StimulationAction:"Talk"},desc:null,descString:[`${selfPlaceholder}è½»è½»å’¬èµ·TargetCharacterçš„å¤´å‘.`,`${selfPlaceholder}è½»è½»å’¬èµ·è‡ªå·±çš„å¤´å‘.`],img:"SiblingsCheekKiss"},"XSAct_å—…å¤´å‘":{act:{Name:"XSAct_å—…å¤´å‘",Target:["ItemHood"],TargetSelf:["ItemHood"],MaxProgress:30,MaxProgressSelf:30,Prerequisite:["ItemHoodCovered","TargetItemHoodCovered"],StimulationAction:"Talk"},desc:null,descString:[`${selfPlaceholder}åœ¨TargetCharacterçš„å‘é—´å—…ç€ï¼Œé¼»æ¯å¼¥æ¼«ç€TargetCharacterçš„å‘é¦™.`,`${selfPlaceholder}æ’©èµ·è‡ªå·±çš„å¤´å‘è½»è½»å—…ç€.`],img:"SiblingsCheekKiss"},"XSAct_ç»•å¤´å‘":{act:{Name:"XSAct_ç»•å¤´å‘",Target:["ItemHood"],TargetSelf:["ItemHood"],MaxProgress:30,MaxProgressSelf:30,Prerequisite:["CantUseArms","ItemHoodCovered","TargetItemHoodCovered"]},desc:null,descString:[`${selfPlaceholder}å‹¾èµ·ä¸€ç¼•TargetCharacterçš„å‘ä¸ï¼Œåœ¨æŒ‡å°–ç»•æ¥ç»•å».`,`${selfPlaceholder}å‹¾èµ·è‡ªå·±çš„ä¸€ç¼•å¤´å‘åœ¨æŒ‡å°–ç»•æ¥ç»•å».`],img:"SiblingsCheekKiss"},"XSAct_çš±é¼»å­":{act:{Name:"XSAct_çš±é¼»å­",Target:[""],TargetSelf:["ItemNose"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["ItemHoodCovered"]},desc:null,descString:["",`${selfPlaceholder}çš±äº†çš±è‡ªå·±çš„é¼»å¤´.`],img:"RestHead"},"XSAct_æ‰“å–·åš":{act:{Name:"XSAct_æ‰“å–·åš",Target:[""],TargetSelf:["ItemNose"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["UseMouth","ItemHoodCovered"],StimulationAction:"Talk"},desc:null,descString:["",`${selfPlaceholder}æ‰“äº†ä¸ªå–·åš.`],img:"Kiss"},"XSAct_æ·±å‘¼å¸":{act:{Name:"XSAct_æ·±å‘¼å¸",Target:[""],TargetSelf:["ItemNose"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["UseMouth","ItemHoodCovered"],StimulationAction:"Talk"},desc:null,descString:["",`${selfPlaceholder}æ·±æ·±çš„å¸äº†å£æ°”.`],img:"Kiss"},"XSAct_ä½å¤´":{act:{Name:"XSAct_ä½å¤´",Target:[""],TargetSelf:["ItemHood"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["ItemHoodCovered","MoveHead"]},desc:null,descString:["",`${selfPlaceholder}çº¢æ¶¦ç€è„¸è›‹ä½å¤´é€ƒé¿.`],img:"RestHead"},"XSAct_æ³æ±‚çš„æ‘‡å¤´":{act:{Name:"XSAct_æ³æ±‚çš„æ‘‡å¤´",Target:["ItemHead"],TargetSelf:[""],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["MoveHead"]},desc:null,descString:[`${selfPlaceholder}å¯¹ç€TargetCharacterçš„æ–¹å‘æ³æ±‚çš„æ‘‡å¤´.`,""],img:"RestHead"},"XSAct_æ³æ±‚çš„çœ‹":{act:{Name:"XSAct_æ³æ±‚çš„çœ‹",Target:["ItemHead"],TargetSelf:[""],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["TargetZoneNaked","MoveHead"]},desc:null,descString:[`${selfPlaceholder}æ±ªç€çœ¼ç›æ³æ±‚çš„çœ‹ç€TargetCharacter.`,""],img:"RestHead"},"XSAct_å†…å…«å¤¹è…¿":{act:{Name:"XSAct_å†…å…«å¤¹è…¿",Target:[""],TargetSelf:["ItemLegs"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:[]},desc:null,descString:["",`${selfPlaceholder}é€šçº¢çš„è„¸è›‹å¿è€ç€å¿«æ„Ÿï¼Œå¤§è…¿ç´§ç´§å¤¹èµ·æ¥ï¼Œæ‘†å‡ºç€å†…å…«çš„å§¿åŠ¿ï¼Œèº«ä½“å¾®å¾®é¢¤æŠ–.`],img:"Kick"},"XSAct_å™˜å˜´":{act:{Name:"XSAct_å™˜å˜´",Target:[""],TargetSelf:["ItemMouth","ItemMouth2","ItemMouth3"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["UseMouth"]},desc:null,descString:["",`${selfPlaceholder}æœ‰äº›ä¸æ»¡çš„å™˜èµ·å˜´å·´.`],img:"PoliteKiss"},"XSAct_æŠ¿ä½å˜´å·´":{act:{Name:"XSAct_æŠ¿ä½å˜´å·´",Target:[""],TargetSelf:["ItemMouth","ItemMouth2","ItemMouth3"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["UseMouth"]},desc:null,descString:["",`${selfPlaceholder}æŠ¿ä½å˜´å·´.`],img:"PoliteKiss"},"XSAct_ç˜ªå˜´":{act:{Name:"XSAct_ç˜ªå˜´",Target:[""],TargetSelf:["ItemMouth","ItemMouth2","ItemMouth3"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["UseMouth"]},desc:null,descString:["",`${selfPlaceholder}ç˜ªç€å˜´å·´ï¼Œä¸€å‰¯å§”å±ˆçš„æ ·å­.`],img:"PoliteKiss"},"XSAct_åç›´èº«ä½“":{act:{Name:"XSAct_åç›´èº«ä½“",Target:[""],TargetSelf:["ItemTorso","ItemTorso2"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:[]},desc:null,descString:["",`${selfPlaceholder}æŒºç›´äº†è…°ï¼Œåç›´äº†èº«ä½“.`],img:"Kick"},"XSAct_æŒºèƒ¸æ”¶è…¹":{act:{Name:"XSAct_æŒºèƒ¸æ”¶è…¹",Target:[""],TargetSelf:["ItemBreast"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:[]},desc:null,descString:["",`${selfPlaceholder}æŒºèµ·èƒ¸éƒ¨ï¼Œå¾®æ”¶ä¸‹å·´ï¼Œè…¹éƒ¨ç”¨åŠ›æ”¶è…°.`],img:"Kick"},"XSAct_ç«™ç›´èº«ä½“":{act:{Name:"XSAct_ç«™ç›´èº«ä½“",Target:[""],TargetSelf:["ItemTorso","ItemTorso2"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["NotKneeling"]},desc:null,descString:["",`${selfPlaceholder}æŒºèƒ¸æ”¶è…¹ï¼ŒåŠªåŠ›ç»·ç´§å°è…¿ï¼Œç«™ç›´äº†èº«ä½“.`],img:"Kick"},"XSAct_èº«ä½“ä¸€é¢¤":{act:{Name:"XSAct_èº«ä½“ä¸€é¢¤",Target:[""],TargetSelf:["ItemTorso","ItemTorso2"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:[]},desc:null,descString:["",`${selfPlaceholder}çš„èº«ä½“çŒ›ç„¶é¢¤æŠ–äº†ä¸€ä¸‹.`],img:"Kick"},"XSAct_æ´»åŠ¨å¤§è…¿":{act:{Name:"XSAct_æ´»åŠ¨å¤§è…¿",Target:[""],TargetSelf:["ItemLegs"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:[]},desc:null,descString:["",`${selfPlaceholder}å°è¯•æ´»åŠ¨äº†ä¸€ä¸‹è…¿éƒ¨.`],img:"Kick"},"XSAct_æ´»åŠ¨æ‰‹è‡‚":{act:{Name:"XSAct_æ´»åŠ¨æ‰‹è‡‚",Target:[""],TargetSelf:["ItemArms"],MaxProgress:30,MaxProgressSelf:30,Prerequisite:["CantUseArms"]},desc:null,descString:["",`${selfPlaceholder}ä¸€è¾¹æŒ‰æ‘©ä¸€è¾¹æ´»åŠ¨ç€æ‰‹è‡‚.`],img:"MasturbateHand"},"XSAct_ç»·ç´§è†ç›–":{act:{Name:"XSAct_ç»·ç´§è†ç›–",Target:[""],TargetSelf:["ItemLegs"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["NotKneeling"]},desc:null,descString:["",`${selfPlaceholder}åŠªåŠ›çš„ç»·ç´§è†ç›–ï¼Œå°½å¯èƒ½ç«™çš„æ›´ç›´.`],img:"Kick"},"XSAct_ç»·ç›´è„šè¸":{act:{Name:"XSAct_ç»·ç›´è„šè¸",Target:[""],TargetSelf:["ItemBoots"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:[]},desc:null,descString:["",`${selfPlaceholder}ä¸è‡ªè§‰çš„ç”¨åŠ›ç»·ç›´è„šè¸ï¼Œé‡Šæ”¾æ¶Œæ¥çš„å¿«æ„Ÿ.`],img:"Kick"},"XSAct_èœ·ç¼©è„šè¶¾":{act:{Name:"XSAct_èœ·ç¼©è„šè¶¾",Target:[""],TargetSelf:["ItemBoots"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:[]},desc:null,descString:["",`${selfPlaceholder}è„šè¶¾äº’ç›¸çº ç»“ï¼Œåˆæ—¶è€Œèœ·ç¼©ï¼Œå¿è€ç€å¿«æ„Ÿè¢­æ¥.`],img:"Kick"},"XSAct_è¸®è„š":{act:{Name:"XSAct_è¸®è„š",Target:[""],TargetSelf:["ItemBoots"],MaxProgress:20,MaxProgressSelf:20,Prerequisite:["CantUseFeet"]},desc:null,descString:["",`${selfPlaceholder}åŠªåŠ›çš„è¸®èµ·è„š.`],img:"Kick"}},this.prerequisiteDict={ItemHoodCovered:{Name:"ItemHoodCovered",Action:args=>{const acting=args[1];return this.Judgment.ItemHoodCovered(acting)}},TargetItemHoodCovered:{Name:"TargetItemHoodCovered",Action:args=>{const acted=args[2];return this.Judgment.ItemHoodCovered(acted)}},ItemNoseCovered:{Name:"ItemNoseCovered",Action:args=>{const acting=args[1];return this.Judgment.ItemNoseCovered(acting)}},Kneeling:{Name:"Kneeling",Action:args=>{const acting=args[1];return this.Judgment.Kneeling(acting)}},NotKneeling:{Name:"NotKneeling",Action:args=>{const acting=args[1];return this.Judgment.NotKneeling(acting)}}},this.Judgment={ItemHoodCovered:acting=>""===InventoryPrerequisiteMessage(acting,"HoodEmpty"),ItemNoseCovered:acting=>InventoryGroupIsBlocked(acting,"NoseEmpty",!0),Kneeling:acting=>acting.IsKneeling(),NotKneeling:acting=>!acting.IsKneeling()}}Init(){this.moduleName="ActivityModule",this.priority=50}Load(){this.LoadActivity(),this.hookListHandler(),this.Loaded=!0}hookListHandler(){hookFunction("ServerSend",5,((args,next)=>{var _a,_b,_c;if("ChatRoomChat"==args[0]&&"Activity"==(null===(_a=args[1])||void 0===_a?void 0:_a.Type)){let data=args[1];if(0==(null!==(_c=null===(_b=data.Dictionary[3])||void 0===_b?void 0:_b.ActivityName)&&void 0!==_c?_c:"").indexOf("XSAct_")){let{metadata:metadata,substitutions:substitutions}=ChatRoomMessageRunExtractors(data,Player),msg=ActivityDictionaryText(data.Content);msg=CommonStringSubstitute(msg,null!=substitutions?substitutions:[]),data.Dictionary.push({Tag:"MISSING ACTIVITY DESCRIPTION FOR KEYWORD "+data.Content,Text:msg})}}return next(args)})),hookFunction("ActivityCheckPrerequisite",500,((args,next)=>{const prereq=args[0];if(prereq in this.prerequisiteDict){return this.prerequisiteDict[prereq].Action(args)}return next(args)})),hookFunction("DrawImageResize",10,((args,next)=>{const parts=args[0].split("/"),aName=parts[parts.length-1].replace(".png","");if(0==aName.indexOf("XSAct_")){const resultName=`Assets/Female3DCG/Activity/${this.activityToAddDict[aName].img}.png`;return args[0]=resultName,next(args)}return next(args)})),hookFunction("ChatRoomMessage",this.priority,((args,next)=>{var _a,_b,_c,_d,_e,_f;const data=args[0];if(conDebug({name:"ChatRoomMessage",type:MSGType.DebugLog,content:data}),"Activity"==data.Type){const actName=null===(_a=data.Dictionary[3])||void 0===_a?void 0:_a.ActivityName,SourceCharacter=null===(_b=data.Dictionary[0])||void 0===_b?void 0:_b.SourceCharacter,TargetCharacter=null===(_c=data.Dictionary[1])||void 0===_c?void 0:_c.TargetCharacter;"Tickle"!=actName||Number.isNaN(TargetCharacter)||TargetCharacter!=(null===Player||void 0===Player?void 0:Player.MemberNumber)||(conDebug({type:MSGType.DebugLog,name:"æ£€æµ‹åˆ°è‡ªå·±ä¸ºç›®æ ‡çš„ç˜™ç—’åŠ¨ä½œ",content:{"é«˜æ½®é˜¶æ®µ":null===(_d=Player.ArousalSettings)||void 0===_d?void 0:_d.OrgasmStage,"æŠµæŠ—éš¾åº¦":ActivityOrgasmGameResistCount}}),1==(null===(_e=Player.ArousalSettings)||void 0===_e?void 0:_e.OrgasmStage)&&(conDebug({type:MSGType.DebugLog,name:"æ•æ‰åˆ°æŠµæŠ—åœºæ™¯ï¼Œå¼€å§‹æˆªæ–­æŠµæŠ— å¢åŠ éš¾åº¦ å¹¶é‡æ–°è§¦å‘",content:{"é«˜æ½®é˜¶æ®µ":null===(_f=Player.ArousalSettings)||void 0===_f?void 0:_f.OrgasmStage,"æŠµæŠ—éš¾åº¦":ActivityOrgasmGameResistCount}}),ActivityOrgasmGameResistCount++,SendActivity("{target}ç´§é—­åŒçœ¼å°½åŠ›æŠµæŠ—ç€é«˜æ½®ï¼Œä½†è¢«{source}çš„ç˜™ç—’å¹²æ‰°ï¼Œä»å˜´å·´é‡Œæ³„éœ²å‡ºä¸€å£°å‹æŠ‘çš„å‘»åŸï¼Œä¸æ­¢æ˜¯å¦è¿˜èƒ½å¿ä½.",SourceCharacter,TargetCharacter),ActivityOrgasmStop(Player,100),ActivityOrgasmPrepare(Player)))}return next(args)}))}LoadActivity(){conDebug("åŠ è½½è‡ªå®šä¹‰æ´»åŠ¨");let actLength=0;for(const aN in this.activityToAddDict){this.pushToActivity(this.activityToAddDict[aN].act),this.activityDictAdd();const activityDesc=this.activityToAddDict[aN].desc;null==activityDesc||activityDesc.forEach((d=>{null===ActivityDictionary||void 0===ActivityDictionary||ActivityDictionary.push(d)})),actLength+=1}conDebug(`è‡ªå®šä¹‰æ´»åŠ¨åŠ è½½å®Œæˆ.åŠ¨ä½œæ•°: ${actLength}`)}activityDictAdd(){for(const a in this.activityToAddDict){const pendingActivity=this.activityToAddDict[a],actName=pendingActivity.act.Name,nameWithoutPrefix=actName.substring(6),actTarget=pendingActivity.act.Target,actTargetSelf=pendingActivity.act.TargetSelf,addedValues=[];if(addedValues.push([`ActivityAct_${actName}`,`${nameWithoutPrefix}`]),addedValues.push([`Activity${actName}`,`${nameWithoutPrefix}`]),actTarget.length>0)for(const aT of actTarget)addedValues.push([`Label-ChatOther-${aT}-${actName}`,`${nameWithoutPrefix}`]),addedValues.push([`ChatOther-${aT}-${actName}`,pendingActivity.descString[0]]);if(void 0!==actTargetSelf&&"boolean"!=typeof actTargetSelf&&actTargetSelf.length>0)for(const aTS of actTargetSelf)addedValues.push([`Label-ChatSelf-${aTS}-${actName}`,`${nameWithoutPrefix}`]),addedValues.push([`ChatSelf-${aTS}-${actName}`,pendingActivity.descString[1]]);pendingActivity.desc=addedValues}}pushToActivity(activity){ActivityFemale3DCG.push(activity),ActivityFemale3DCGOrdering.push(activity.Name)}getAllAct(){const result=[];for(const a in this.activityToAddDict){const suffix=a.substring(6);result.push(suffix)}return conDebug({content:result,name:"ActivityNameXiaosu_onlyName",type:MSGType.DebugLog}),result}}const buildKaomojiMenuCSShref=DEBUG?"https://iceriny.github.io/XiaoSuActivity/dev/kaomojiMenu.css":"https://iceriny.github.io/XiaoSuActivity/main/kaomojiMenu.css";class ChatroomModule extends BaseModule{constructor(){super(...arguments),this.moan=[" å—¯~â¤.."," æ˜‚~â¤å“ˆå•Š.."," --å””~å‘œ.."," å§†å—¯~â¤..."," --å˜¶-å•Š~"," å””..â¤å•Š~"," --â¤å˜¶å“ˆ~"," â¤å‘€~"," â¤...å‘€å—¯.."," â¤.å“¦~å—¯~."]}Load(){this.hookListHandler(),this.Loaded=!0}Init(){this.moduleName="ChatroomModule",this.priority=30;const linkElement=document.createElement("link");linkElement.rel="stylesheet",linkElement.type="text/css",linkElement.href=buildKaomojiMenuCSShref,document.head.appendChild(linkElement)}hookListHandler(){hookFunction("CommandParse",0,((args,next)=>{let msg=args[0];const match=msg.match(/^`([1-9])?(m)?( )? (.*)/);match&&(msg="m"!=match[2]?this.stammerHandler(match[4],parseInt(match[1]),!match[3],!1):this.stammerHandler(match[4],parseInt(match[1]),!match[3],!0));const kaomojiMatch=msg.match(/^\|(.*)/);if(!kaomojiMatch)return args[0]=msg,next(args);ChatroomModule.kaomojiHandler(kaomojiMatch[1]);document.getElementById("InputChat").value=""}))}ExportChat(time_limit=null){const exportName=`${null===ChatRoomData||void 0===ChatRoomData?void 0:ChatRoomData.Name}_${(new Date).toLocaleString()}`;copyAndDownloadHtmlElement(document.getElementById("TextAreaChatLog"),exportName,time_limit)}stammerHandler(content,tenfoldStammeringProbability,isSegmentForCH,haveMoan){conDebug(`stammerHandler: content: ${content} tenfoldStammeringProbability: ${tenfoldStammeringProbability}`),Number.isNaN(tenfoldStammeringProbability)&&(tenfoldStammeringProbability=3);const stammeringProbability=tenfoldStammeringProbability/10,segmentList=isSegmentForCH?function(str){if(conDebug({name:"segmentForCHTest",type:MSGType.DebugLog,content:{Intl:!!window.Intl,Segmenter:!!window.Intl.Segmenter,GAME_LANG:TranslationLanguage.toLowerCase()}}),window.Intl&&window.Intl.Segmenter&&"cn"===TranslationLanguage.toLowerCase()){const segmenterResult=new Intl.Segmenter("zh",{granularity:"word"}).segment(str),results=[];for(const segment of segmenterResult)results.push(segment.segment);return conDebug(`segmentForCH: ${results}`),results}return null}(content.replace(/\s/g,"")):void 0,stringArray=segmentList||content.split(" ");return this.stammerForList(stringArray,stammeringProbability,haveMoan)}stammerForList(messageList,stammeringProbability,haveMoan){var _a,_b;let result="";for(let i=0;i<messageList.length;i++){const currentWord=messageList[i];result+=currentWord,Math.random()<stammeringProbability&&(result+=this.addStammerEffect(currentWord)),haveMoan&&(null===(_a=Player.ArousalSettings)||void 0===_a?void 0:_a.Progress)&&100*Math.random()<=(null===(_b=Player.ArousalSettings)||void 0===_b?void 0:_b.Progress)&&(result+=this.moan[Math.floor(Math.random()*this.moan.length)]),i<messageList.length-1?Math.random()<stammeringProbability&&(result+="-"):result+="..."}return conDebug({name:"stammer",type:MSGType.DebugLog,content:result}),result}addStammerEffect(word,depth=0){if(depth>=3)return word;let result=Math.random()<.5?"...":`-${word}`;return Math.random()<.2&&(result=this.addStammerEffect(result,depth+1)),result}static kaomojiHandler(message){const kaomojiMenu=this.buildKaomojiMenu(message);if(kaomojiMenu){const textAreaChatLog=document.getElementById("TextAreaChatLog");null==textAreaChatLog||textAreaChatLog.appendChild(kaomojiMenu),setTimeout((()=>{kaomojiMenu.remove()}),1e4)}}static buildKaomojiMenu(key){const kaomojiList="all"==key?Object.values(this.kaomojiSet).flatMap((v=>v)):this.kaomojiSet[key];if(kaomojiList.length>0){const menu=document.createElement("div"),menuTitle=document.createElement("div"),kaomojiContainer=document.createElement("div"),kaomojiClassName="kaomoji";menu.appendChild(menuTitle),menu.appendChild(kaomojiContainer),menu.className="kaomoji-menu",kaomojiContainer.className="kaomoji-container",menuTitle.innerText=key;for(const kaomoji of kaomojiList){const kaomojiElement=document.createElement("div");kaomojiElement.className=kaomojiClassName,kaomojiElement.innerText=kaomoji,"help"!==key&&kaomojiElement.addEventListener("click",(()=>{var msg;msg=kaomojiElement.innerHTML,ServerSend("ChatRoomChat",{Type:"Chat",Content:msg})})),kaomojiContainer.appendChild(kaomojiElement)}return menu}}}ChatroomModule.kaomojiSet={help:["all ==> å…¨éƒ¨è¡¨æƒ…","hp ==> å¼€å¿ƒ","sd ==> ä¼¤å¿ƒ","sy ==> å®³ç¾","ar ==> ç”Ÿæ°”","ap ==> æƒŠè®¶","cf ==> å›°æƒ‘","nt ==> ææ€ªé¡½çš®"],hp:["(ï¿£wï¿£)ãƒ","(â‰§âˆ‡â‰¦)ï¾‰","o(^â–½^)o","(ï¿£ï¸¶ï¿£)â†—","o(*ï¿£â–½ï¿£*)o","(pâ‰§wâ‰¦q)","ã„Ÿ(â‰§â—‡â‰¦)ã„","(/â‰§â–½â‰¦)/","(ã€€ï¾Ÿâˆ€ï¾Ÿ) ï¾‰â™¡","o(*ï¿£ï¸¶ï¿£*)o","(à¹‘Â¯âˆ€Â¯à¹‘)","(â‰§âˆ€â‰¦)ã‚","Ï†(â‰§Ï‰â‰¦*)â™ª","â•°(*Â°â–½Â°*)â•¯","(*^â–½^*)","(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§","(oã‚œâ–½ã‚œ)oâ˜†[BINGO!]","(^â–½^ )","<(*ï¿£â–½ï¿£*)/","â”Œ|*Â´âˆ€ï½€|â”˜","â™ª(Â´âˆ‡`*)"],sd:["ãƒ†_ãƒ‡","â–¡_â–¡","â”­â”®ï¹â”­â”®","â•¥ï¹â•¥...","o(Tãƒ˜To)","ã€’â–½ã€’","Îµ(â”¬â”¬ï¹â”¬â”¬)3","(;Â´à¼àº¶Ğ”à¼àº¶`)","(ãƒã¸`ã€)","ï¼ˆ-_-ã€‚ï¼‰","(ãƒã¸ï¿£ã€)"],sy:["|Ï‰ãƒ»ï¼‰","|ï½¥Ï‰ï½¥ï½€)","â—•à¸ºâ€¿â—•à¸ºâœ¿à¸º)","ã¤ï¹âŠ‚","(* /Ï‰ï¼¼*)","o(*////â–½////*)q","(*/Ï‰ï¼¼*)","(â€²â–½`ã€ƒ)","(âœ¿â—¡â€¿â—¡)","(/â–½ï¼¼)","(à¹‘Â´ã…‚`à¹‘)","(â—¡á´—â—¡âœ¿)"],ar:["(Ïƒï½€Ğ´â€²)Ïƒ","ï¼¼(ã‚œãƒ­ï¼¼)(ï¼ãƒ­ã‚œ)ï¼","<(ï¼ï¸¿ï¼)>","(ãƒ¼`Â´ãƒ¼)","ï¼ˆï½€ã¸Â´ï¼‰","(-__-)=@))> o<)","(///ï¿£çš¿ï¿£)â—‹ï½","â”»â”â”»ï¸µâ•°(â€µâ–¡â€²)â•¯ï¸µâ”»â”â”»","â†’)â•¥ï¹â•¥)","æŠ½!!(ï¿£Îµ(#ï¿£)â˜†â•°â•®(ï¿£â–½ï¿£///)","(ï¿£Îµ(#ï¿£)â˜†â•°â•®o(ï¿£çš¿ï¿£///)","(* ï¿£ï¸¿ï¿£)","ï¼ˆï¼ƒï¿£ï½ï¿£ï¼ƒï¼‰","(âŠ™xâŠ™;)","o(*â‰§â–½â‰¦)ãƒ„â”â”â”“","(ãƒÏ‰<ã€‚)ãƒ))â˜†.ã€‚","(ã€ƒï¼ç›®ï¼œ)","( Ïƒ'Ï‰')Ïƒ","o(â€²ç›Š`)o","(ã€ƒï¼ç›®ï¼œ)","o(â‰§å£â‰¦)o","ï¼¯(â‰§å£â‰¦)ï¼¯","...(*ï¿£ï¼ï¿£)ãƒ[ç­‰ç­‰æˆ‘â€¦]","ï¼ˆâ‰§0â‰¦ï¼‰"],sp:["â€™(Â°ãƒ¼Â°ã€ƒ)","(ãƒ¼ãƒ¼ã‚›)","(â—‹Â´ï½¥Ğ´ï½¥)ï¾‰","wow~ âŠ™oâŠ™","~(ï¿£0ï¿£)/","Î£(ï½€Ğ´â€²*ãƒ)ãƒ","Î£(ã£ Â°Ğ” Â°;)ã£","(âŠ™ËâŠ™)","w(ï¾ŸĞ”ï¾Ÿ)w","ï½(oãƒ»Ï‰ãƒ»o)ï½","âŠ™â–½âŠ™"],cf:["( -'`-)","(=â€²ãƒ¼`)","( -'`-; )","(ãƒ»-ãƒ»*)","( ï½€Ğ´â€²)","(ï¿£mï¿£ï¼‰","( â•¯â–½â•°)"],nt:["(Ë‰â–½ï¿£ï½) åˆ‡~~","(ï¿£wï¿£)ãƒ","( ï¿£ãƒ¼ï¿£)","(â€¾â—¡â—)","(ï¿£_,ï¿£ )","( ï¹ ï¹ ) ~â†’","<(ï¿£ ï¹Œ ï¿£)@m"]};const timeRangeRegex=/^(((0|1)\d|2[0-3]):[0-5]\d)-(((0|1)\d|2[0-3]):[0-5]\d)$/;class CommandsModule extends BaseModule{constructor(){super(...arguments),this.commandsDict={help:{Tag:"help",Description:"æ˜¾ç¤º [å°é…¥çš„æ´»åŠ¨æ¨¡ç»„] çš„ç›¸å…³å‘½ä»¤.",Action:(args,msg,parsed)=>{this.DisplayHelp()}},export:{Tag:"export",Description:"å¯¼å‡ºå½“å‰èŠå¤©å®¤çš„èŠå¤©è®°å½•. è¾“å…¥: â€˜/xsa export -hâ€™ æ˜¾ç¤ºå¯¼å‡ºå‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•.",Action:(args,msg,parsed)=>{const params=this.getCommandParameters(parsed);if("h"==params)ChatRoomSendLocal("è¾“å…¥: â€˜/xsa export -[æ—¶é—´]â€™å¯¼å‡ºæŒ‡å®šæ—¶é—´èŒƒå›´å†…çš„èŠå¤©è®°å½•.\nä¾‹å¦‚: â€˜/xsa export -05:34-20:40â€™\né»˜è®¤å¯¼å‡ºå½“å‰èŠå¤©å®¤çš„å…¨éƒ¨èŠå¤©è®°å½•.\næ³¨æ„! \nå¦‚æœæ—¶é—´æ®µè¿‡é•¿ä¾‹å¦‚ç¬¬ä¸€å¤©çš„05:34åˆ°ç¬¬äºŒå¤©çš„06:00åˆ™å¯èƒ½å‡ºç°å¯¼å‡ºé”™è¯¯.",2e4);else if(""===params)conDebug("å¯¼å‡ºå½“å‰èŠå¤©å®¤çš„å…¨éƒ¨èŠå¤©è®°å½•"),GetModule("ChatroomModule").ExportChat();else if(timeRangeRegex.test(params)){conDebug(`å¯¼å‡ºæŒ‡å®šçš„ ${params} æ—¶é—´æ®µçš„èŠå¤©è®°å½•`);const separatorIndex=params.indexOf("-");if(-1!==separatorIndex){const time_limit={minTime:params.slice(0,separatorIndex).trim(),maxTime:params.slice(separatorIndex+1).trim()};GetModule("ChatroomModule").ExportChat(time_limit)}}}},v:{Tag:"v",Description:"æ˜¾ç¤º [å°é…¥çš„æ´»åŠ¨æ¨¡ç»„] çš„ç‰ˆæœ¬ä¿¡æ¯.",Action:(args,msg,parsed)=>{!function(){let content="";for(const c in CHANGELOG){const version=CHANGELOG[c].version,type=CHANGELOG[c].type==ChangeType.main?"ä¸»ç‰ˆæœ¬":"å¼€å‘ç‰ˆæœ¬",description=CHANGELOG[c].description,changes=CHANGELOG[c].changes;let changesString='<ul style="list-style-position: inside;  padding-left: 0;">';for(const s of changes)changesString+=`<li>${s}</li>`;changesString+="</ul>";const styleForP='style="font-weight: bold; margin: 0;"';content+=`<div style="background-color: ${version!=XSActivity_VERSION||DEBUG||"ä¸»ç‰ˆæœ¬"!==type?"#442E3A":"#764460"}; display: flex; flex-direction: column;"> <p ${styleForP}>ç‰ˆæœ¬: ${version}</p> <p ${styleForP}>ç±»å‹: ${type}</p> <p ${styleForP}>æè¿°: ${description}</p><p>----</p> <p ${styleForP}>æ”¹åŠ¨: ${changesString}</p><p>========</p></div>`}content+="<p>==å½“å‰é¡µé¢æ˜¾ç¤ºæ—¶é—´1åˆ†é’Ÿ==</p>",ChatRoomSendLocal(content,6e4)}()}},act:{Tag:"act",Description:"æ˜¾ç¤º [å°é…¥çš„æ´»åŠ¨æ¨¡ç»„] æ‰€æ·»åŠ çš„å…¨éƒ¨åŠ¨ä½œåˆ—è¡¨.",Action:(args,msg,parsed)=>{let content="";GetModule("ActivityModule").getAllAct().forEach((item=>{content+=`<p style="font-weight: bold; margin: 0;">${item}</p>`})),conDebug(`command: AL    content: ${content}`),ChatRoomSendLocal(content,2e4)}},jieba:{Tag:"jieba",Description:"æ˜¾ç¤º è‡ªåŠ¨ç»“å·´æ•ˆæœ çš„å‘½ä»¤å¸®åŠ©.",Action:(args,msg,parsed)=>{const stressStyle="style='word-wrap: break-word;list-style: square;color: #FFCEE9;background-color: #AB6B8E;border-radius: 3px;padding: .2em .6em;margin: .2em .6em;'";ChatRoomSendLocal(`è¾“å…¥: <span ${stressStyle}>\`</span><span ${stressStyle}>ç©ºæ ¼</span><span style='word-wrap: break-word;list-style: square;color: #B0809B;background-color: #AB6B8E;border-radius: 3px;padding: .2em .6em;margin: .2em .6em;'>ç©ºæ ¼</span> å¼€å¤´çš„è¯å°†ä»¥å£åƒç»“å·´çš„å½¢å¼å‘å‡º.\nç»“å·´ç”Ÿæ•ˆä½ç½®æœ‰ä¸¤ç§æ–¹å¼: å¦‚æœé”®å…¥ä¸¤ä¸ª<span ${stressStyle}>ç©ºæ ¼</span> å°†ä¼šåœ¨ç©ºæ ¼ä½ç½®æ¦‚ç‡äº§ç”Ÿç»“å·´æ•ˆæœ.\nå¦‚æœé”®å…¥ä¸€ä¸ª<span ${stressStyle}>ç©ºæ ¼</span>å°†ä¼šä½¿ç”¨åˆ†è¯ç³»ç»Ÿè¿›è¡Œç»“å·´æ•ˆæœ.\nè¯¥å‘½ä»¤æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°:\nå¦‚æœä»¥<span ${stressStyle}>\`</span><span ${stressStyle}>[1-9]</span> çš„å½¢å¼ä½œä¸ºå¼€å¤´ï¼Œæ•°å­—ä»£è¡¨ç»“å·´ç¨‹åº¦ï¼Œé»˜è®¤ä¸º3ï¼Œè¶Šé«˜å°†è¶Šå£åƒ.\nä¸å¸¦ç»“å·´ç¨‹åº¦å‚æ•°çš„ä¾‹å­:\n<span ${stressStyle}>\`</span> [è¦è¯´ çš„ è¯]\nå¤„ç†ä¹‹åçš„æ•ˆæœå°±å¯èƒ½æ˜¯:  ã€Œ è¦è¯´...-çš„-çš„è¯... ã€=>æ³¨æ„ç©ºæ ¼çš„ä½ç½®.\nå¸¦å‚æ•°çš„å‘½ä»¤æ–¹æ³•:\n<span ${stressStyle}>\`</span>3 [è¦è¯´ çš„ è¯]\næ­¤å¤„çš„3å°±æ˜¯ç»“å·´ç­‰çº§ï¼Œä»£è¡¨ç€æ¯å¤„å¥å­ä¸­çš„ç©ºæ ¼ä½ç½®çš„è¯æ®µéƒ½å°†æœ‰30%çš„æ¦‚ç‡å‘ç”Ÿç»“å·´.ä¸Šé¢çš„è¯å°±æ„å‘³ç€å‘ç”Ÿäº†3ç­‰çº§çš„ç»“å·´æ•ˆæœ.\nå¦‚æœæœ‰ä¸¤ä¸ªç©ºæ ¼: <span ${stressStyle}>\`</span>  [è¦è¯´çš„è¯]\nğŸ’¡å¦å¤–: å¦‚æœæ•°å­—åè·Ÿ<span ${stressStyle}>m</span>ç»“å°¾ï¼Œåˆ™ä¼šåœ¨ç»“å·´å¤„æ ¹æ®å½“å‰å…´å¥‹ç¨‹åº¦æ·»åŠ å‘»åŸæ•ˆæœ.`)}},edge:{Tag:"edge",Description:"æ˜¾ç¤º å…³äºè¾¹ç¼˜æœºåˆ¶çš„ä¿®æ”¹å†…å®¹å¸®åŠ©.",Action:(args,msg,parsed)=>{ChatRoomSendLocal("æ¨¡ç»„ä¿®æ”¹äº†çš„è¾¹ç¼˜æœºåˆ¶:\næ¯æŒç»­45ç§’é’Ÿè¾¹ç¼˜ ,å°†æé«˜ä¸€å±‚é«˜æ½®æŠµæŠ—éš¾åº¦ï¼Œå¹¶ä¸”å¢åŠ 0.3~1.3ç§’çš„å³å°†åˆ°æ¥çš„é«˜æ½®çš„æŒç»­æ—¶é—´-æœ€å¤š27ç§’æŒç»­æ—¶é—´.\n å¦‚æœå¤±å»è¾¹ç¼˜çŠ¶æ€ï¼Œå°†æ¯45ç§’é’Ÿé™ä½ä¸€å±‚é«˜æ½®æŠµæŠ—éš¾åº¦ï¼Œå¹¶ä¸”å‡å°‘0.3~1.3ç§’çš„å³å°†åˆ°æ¥çš„é«˜æ½®çš„æŒç»­æ—¶é—´-æœ€å°‘é«˜æ½®æŒç»­æ—¶é—´èŒƒå›´4~7ç§’.\n\n")}},orgasm:{Tag:"orgasm",Description:"æ˜¾ç¤º å…³äºé«˜æ½®æœºåˆ¶çš„ä¿®æ”¹å†…å®¹å¸®åŠ©.",Action:(args,msg,parsed)=>{ChatRoomSendLocal("å½“è§’è‰²æŠµæŠ—é«˜æ½®æ—¶è¢«æŒ ç—’ï¼Œåˆ™é‡æ–°å¼€å§‹æŠµæŠ—å¹¶ä¸”å¢åŠ ä¸€å±‚éš¾åº¦\nå½“é«˜æ½®æˆ–æŠµæŠ—é«˜æ½®æ—¶ç¦ç”¨è¾“å…¥æ¡†.")}},kaomoji:{Tag:"kaomoji",Description:"æ˜¾ç¤º å¿«é€Ÿé¢œæ–‡å­— çš„ä½¿ç”¨è¯´æ˜.",Action:(args,msg,parsed)=>{const stressStyle="style='word-wrap: break-word;list-style: square;color: #FFCEE9;background-color: #AB6B8E;border-radius: 3px;padding: .2em .6em;margin: .2em .6em;'";ChatRoomSendLocal(`è¾“å…¥<span ${stressStyle}>|</span><span style='word-wrap: break-word;list-style: square;color: #B0809B;background-color: #AB6B8E;border-radius: 3px;padding: .2em .6em;margin: .2em .6em;'>å‚æ•°</span>æ˜¾ç¤ºé¢œæ–‡å­—é¢æ¿ï¼Œç‚¹å‡»é¢æ¿ä¸Šçš„è¡¨æƒ…ç›´æ¥å°†å…¶å‘é€ï¼Œé¢æ¿å°†æ˜¾ç¤º10ç§’é’Ÿåè‡ªåŠ¨æ¶ˆå¤±ã€‚\n å½“å‰çš„å‚æ•°æœ‰:\n <span ${stressStyle}>help</span>æ˜¾ç¤ºæ‰€æœ‰çš„å‚æ•°ä½œç”¨ã€‚\n <span ${stressStyle}>all</span>æ˜¾ç¤ºå…¨éƒ¨è¡¨æƒ…åŒ…ã€‚\n <span ${stressStyle}>hp</span>æ˜¾ç¤ºå¼€å¿ƒçš„é¢œæ–‡å­—åŒ…ã€‚\n <span ${stressStyle}>sd</span>æ˜¾ç¤ºä¼¤å¿ƒçš„é¢œæ–‡å­—åŒ…ã€‚\n <span ${stressStyle}>sy</span>æ˜¾ç¤ºå®³ç¾çš„é¢œæ–‡å­—åŒ…ã€‚\n <span ${stressStyle}>ar</span>æ˜¾ç¤ºç”Ÿæ°”çš„é¢œæ–‡å­—åŒ…ã€‚\n <span ${stressStyle}>sp</span>æ˜¾ç¤ºæƒŠè®¶çš„é¢œæ–‡å­—åŒ…ã€‚\n <span ${stressStyle}>cf</span>æ˜¾ç¤ºç–‘æƒ‘çš„é¢œæ–‡å­—åŒ…ã€‚\n <span ${stressStyle}>nt</span>æ˜¾ç¤ºé¡½çš®ææ€ªçš„é¢œæ–‡å­—åŒ…ã€‚\n                `)}}}}Load(){CommandCombine({Tag:"xsa",Description:"æ˜¾ç¤º [å°é…¥çš„æ´»åŠ¨æ¨¡ç»„] çš„ç›¸å…³å‘½ä»¤.",Action:(args,msg,parsed)=>{parsed.length>0?this.CommandHandler(parsed):this.DisplayHelp()}}),this.Loaded=!0}Init(){this.moduleName="CommandsModule",this.priority=20}getCommandParameters(parsed){const lastParam=parsed[parsed.length-1];return lastParam.startsWith("-")?lastParam.slice(1):""}DisplayHelp(msg=void 0){if(void 0===msg){let content="";for(const c in this.commandsDict)content+=`/xsa ${c} ${this.commandsDict[c].Description}\n`;content+=`å°é…¥çš„æ´»åŠ¨æ¨¡ç»„ ç‰ˆæœ¬å·: ${XSActivity_VERSION}\n`,ChatRoomSendLocal(content,1e4)}else ChatRoomSendLocal(msg,1e4)}CommandHandler(parsed){var _a,_b,_c,_d;const parsedCount=parsed.length;if(0==parsedCount&&this.DisplayHelp(),parsedCount>=1){const last=parsed[parsedCount-1];if(last.startsWith("-")){const cmd=parsed[parsedCount-2];cmd in this.commandsDict&&(null===(_b=null===(_a=this.commandsDict[cmd])||void 0===_a?void 0:_a.Action)||void 0===_b||_b.call(_a,"","",parsed))}else last in this.commandsDict&&(null===(_d=null===(_c=this.commandsDict[last])||void 0===_c?void 0:_c.Action)||void 0===_d||_d.call(_c,"","",parsed))}}}var _a$1,_a;class DataModule extends BaseModule{Load(){this.Loaded=!0}Init(){this.moduleName="DataModule",this.priority=0,window.BROWSER_NAME=_a$1.browserName,window.BROWSER_VERSION=_a$1.browserVersion}}_a$1=DataModule,DataModule.userAgentString=navigator.userAgent,DataModule.browserVersionRegex=/(chrome|firefox|safari|opera|edge|msie|trident(?=\/))\/?\s*(\d+)/i,DataModule.match=_a$1.userAgentString.match(_a$1.browserVersionRegex),DataModule.browserName=_a$1.match?_a$1.match[1]:"unknown",DataModule.browserVersion=_a$1.match?parseInt(_a$1.match[2]):-1;class TimerProcessInjector extends BaseModule{static set setProcessInjectionSequence(sequence){for(const c of sequence)this.processInjectionSet[c.name]=c}Load(){TimerProcessInjector.ProcessInjection(),this.Loaded=!0}Init(){this.moduleName="TimerProcessInjector",this.priority=999}static ProcessInjection(){TimerProcessInjector.InjectionSort();for(const c of this.processInjectionSequence)this.TimerLastCycleCallSet[c.name]=-1;conDebug(`[TimerProcessInjector] Injection Process... Injection Count: ${this.processInjectionSequence.length}`),hookFunction("TimerProcess",100,((args,next)=>{const currentTime=CommonTime();for(const c of this.processInjectionSequence)-1==this.TimerLastCycleCallSet[c.name]&&this.TimerLastCycleCallSet[c.name],c.preconditions()&&this.TimerLastCycleCallSet[c.name]+c.timeInterval<=currentTime&&(c.code(),this.TimerLastCycleCallSet[c.name]=currentTime);return next(args)}))}static InjectionSort(){this.processInjectionSequence=Object.values(this.processInjectionSet).sort(((a,b)=>a.priority-b.priority))}}TimerProcessInjector.processInjectionSequence=[],TimerProcessInjector.processInjectionSet={},TimerProcessInjector.TimerLastCycleCallSet={};class ArousalModule extends BaseModule{constructor(){super(...arguments),this.EdgeTimerLastCycleCall=0,this.OrgasmTimerLastCycleCall=0,this.descriptionOfEnduranceActivities=["{source}è„šè¶¾ä¸€èœ·ä¸€ç¼©ï¼Œéš¾è€çš„äº¤ç»‡.","{source}é—­çœ¼å¿è€ï¼Œé¼»æ¯ä¸­æ³„éœ²å‡ºç²‰çº¢çš„å–˜æ¯.","{source}èœ·ç¼©è„šè¶¾å¿è€ç€è¿ç»­çš„å¿«æ„Ÿ.","{source}éš¾è€çš„åŒè…¿é¢¤æŠ–ç€ï¼Œèº«ä½“çš„æ¯ä¸€å¤„éƒ½å……æ»¡å¿«æ„Ÿ.","{source}æ‹¼å‘½å’¬ä½ç‰™é½¿ï¼Œå´ä»é¼»è…”æ³„éœ²å‡ºè¯±äººçš„å£°éŸ³.","{source}åœ¨æ±¹æ¶Œçš„å¿«æ„Ÿä¸‹æµ‘èº«ç²‰çº¢ï¼Œå¥‹åŠ›çš„æƒ³è¦å¿ä½é«˜æ½®.","{source}æµ‘èº«é¢¤æŠ–çš„æŠµæŠ—é«˜æ½®çš„é€¼è¿‘."],this.inputDefaultStyle=void 0}Init(){this.moduleName="ArousalModule",this.priority=60,TimerProcessInjector.setProcessInjectionSequence=[{name:"EdgeTimerLastCycleCall",priority:0,preconditions:()=>{var _a;return void 0!==window.EdgeCount&&void 0!==(null===(_a=Player.ArousalSettings)||void 0===_a?void 0:_a.Progress)},timeInterval:45e3,code:()=>{Player.ArousalSettings.Progress>=93?(window.EdgeCount++,ActivityOrgasmGameResistCount++):(window.EdgeCount>=1&&window.EdgeCount--,ActivityOrgasmGameResistCount>=1&&ActivityOrgasmGameResistCount--)}},{name:"OrgasmTimerLastCycleCall",priority:1,preconditions:()=>"ChatRoom"==CurrentScreen&&void 0!==Player.MemberNumber,timeInterval:1500,code:()=>{var _a,_b;const inputElement=document.getElementById("InputChat"),orgasmStage=null===(_a=Player.ArousalSettings)||void 0===_a?void 0:_a.OrgasmStage;2==orgasmStage||1==orgasmStage?(this.setFormElementsForAbsentState(inputElement,!0),1==(null===(_b=Player.ArousalSettings)||void 0===_b?void 0:_b.OrgasmStage)&&Math.random()<.3&&SendActivity(this.getEndureDesc,Player.MemberNumber)):this.setFormElementsForAbsentState(inputElement,!1)}}]}Load(){window.EdgeCount=0,this.patchListHandler(),this.Loaded=!0}get getEndureDesc(){return this.descriptionOfEnduranceActivities[Math.floor(Math.random()*this.descriptionOfEnduranceActivities.length)]}setFormElementsForAbsentState(formElements,isAbsent){formElements&&(isAbsent?formElements.readOnly||(this.inputDefaultStyle||(this.inputDefaultStyle={backgroundColor:formElements.style.backgroundColor,borderColor:formElements.style.borderColor,borderRadius:formElements.style.borderRadius}),formElements.readOnly=!0,formElements.style.backgroundColor="#8d6f83",formElements.style.borderColor="#ea44a9",formElements.style.borderRadius="5px"):formElements.readOnly&&(formElements.readOnly=!1,this.inputDefaultStyle&&(formElements.style.backgroundColor=this.inputDefaultStyle.backgroundColor,formElements.style.borderColor=this.inputDefaultStyle.borderColor,formElements.style.borderRadius=this.inputDefaultStyle.borderRadius)))}patchListHandler(){var functionName,patches;functionName="ActivityOrgasmStart",patches={"C.ArousalSettings.OrgasmTimer = CurrentTime + (Math.random() * 10000) + 5000;":"if (window.EdgeCount === undefined) {\n                C.ArousalSettings.OrgasmTimer = CurrentTime + (Math.random() * 10000) + 5000;\n            } else {\n                const addedTime = (Math.random() + 0.3) * 1000 * window.EdgeCount;\n                C.ArousalSettings.OrgasmTimer = CurrentTime + (addedTime > 20000 ? 20000 : addedTime) + 4000 + (3000 * Math.random());\n            }","ActivityOrgasmGameResistCount = 0;":"ActivityOrgasmGameResistCount = Math.round(ActivityOrgasmGameResistCount / 2);"},bcModSDK.patchFunction(functionName,patches)}}class ModuleLoader{static InitModules(){return this.generateModule(),void 0!==this.mList&&this.mList.sort(((a,b)=>a.priority-b.priority)).forEach((m=>{m.Init(),conDebug(`æ¨¡å— ${m.moduleName} å°è¯•åˆå§‹åŒ–å®Œæˆ`),this.modulesInitCount++})),this.modulesInitCount}static LoadModules(){return void 0!==this.mList&&this.mList.forEach((m=>{m.Load(),conDebug(`æ¨¡å— ${m.moduleName} å·²å°è¯•åŠ è½½`),this.modulesLoadCount++})),this.CheckModulesLoaded()?(this.CompleteLoadingSuccessful=!0,window.XSActivity_Loaded=!0):(this.CompleteLoadingSuccessful=!1,window.XSActivity_Loaded=!1),this.modulesLoadCount}static CheckModulesLoaded(){if(6!=this.modulesLoadCount||this.modulesInitCount!=this.modulesLoadCount)return conDebug(`æ¨¡å—åŠ è½½å¤±è´¥ï¼Œæ¨¡å—æ•°é‡ä¸åŒ¹é…ï¼Œåˆå§‹åŒ–æ•°é‡ä¸º${this.modulesInitCount}æ¨¡å—åŠ è½½æ•°é‡ä¸º${this.modulesLoadCount}ï¼Œåº”ä¸º6`),!1;if(void 0===_a.mList)return conDebug("æ¨¡å—åŠ è½½å¤±è´¥ï¼Œæ¨¡å—åˆ—è¡¨æœªåˆå§‹åŒ–"),!1;for(const m of _a.mList)if(!m.Loaded)return conDebug(`æ¨¡å—åŠ è½½å¤±è´¥ï¼Œæ¨¡å— ${m.moduleName} æœªåŠ è½½å®Œæˆ`),!1;return conDebug("æ¨¡å—åŠ è½½å®Œæˆ"),!0}static pushToModules(module){this.modules[module.moduleName]=module,void 0!==this.mList?this.mList.push(module):this.mList=[module]}static generateModule(){let generateModuleCount=0;for(const mN in _a.ModuleMap)"Base"!==mN&&void 0===this.modules[mN]&&(_a.ModuleMap[mN](),generateModuleCount++);return generateModuleCount}}function init(){if(window.XSActivity_Loaded)return;const InitModuleCount=ModuleLoader.InitModules();conDebug({type:MSGType.Workflow_Log,name:"XSActivity Initialized!",content:`Init ${InitModuleCount} modules `});const moduleCount=ModuleLoader.LoadModules();if(conDebug({type:MSGType.Workflow_Log,name:"XSActivity Loaded!",content:`Loaded ${moduleCount} modules    FullLoaded: ${ModuleLoader.CompleteLoadingSuccessful}`}),!ModuleLoader.CompleteLoadingSuccessful)throw new Error("XSActivity load or init failed")}return _a=ModuleLoader,ModuleLoader.modules=modules,ModuleLoader.modulesLoadCount=0,ModuleLoader.modulesInitCount=0,ModuleLoader.CompleteLoadingSuccessful=!1,ModuleLoader.ModuleMap={Base:()=>{throw new Error("Baseä¸ºæ¨¡å—çš„æŠ½è±¡ç±»ï¼Œè¯·å‹¿åŠ è½½")},TimerProcessInjector:()=>{_a.pushToModules(new TimerProcessInjector)},ActivityModule:()=>{_a.pushToModules(new ActivityModule)},ChatroomModule:()=>{_a.pushToModules(new ChatroomModule)},CommandsModule:()=>{_a.pushToModules(new CommandsModule)},DataModule:()=>{_a.pushToModules(new DataModule)},ArousalModule:()=>{_a.pushToModules(new ArousalModule)}},conDebug({name:"Start Init",type:MSGType.Workflow_Log,content:"Init wait"}),null!=CurrentScreen&&"Login"!==CurrentScreen||hookFunction("LoginResponse",0,((args,next)=>{next(args),conDebug({name:"Init! Login Response caught",content:args,type:MSGType.Workflow_Log});const response=args[0];(response&&"string"==typeof response.Name&&"string"==typeof response.AccountName||!ModuleLoader.CompleteLoadingSuccessful)&&init()})),exports.init=init,exports}({});
//# sourceMappingURL=XSActivity_dev.js.map
